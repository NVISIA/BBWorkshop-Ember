<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1024" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <title>SPA Workshop Code</title>
    
    <meta name="description" content="Slides for explaining basic Backbone concepts and getting attendees started on the exercises." />
    <meta name="author" content="nvisia" />

    <link href="http://fonts.googleapis.com/css?family=Open+Sans:regular,semibold,italic,italicsemibold|PT+Sans:400,700,400italic,700italic|PT+Serif:400,700,400italic,700italic" rel="stylesheet" />
    <link href="css/impress-nvisia.css" rel="stylesheet" />
    
    <link rel="shortcut icon" href="favicon.png" />
    <link rel="apple-touch-icon" href="apple-touch-icon.png" />
</head>

<!--
    When impress.js script detects that browser supports all required features, this class name will
    be removed.
-->
<body class="impress-not-supported">

<!--
    For example this fallback message is only visible when there is `impress-not-supported` class on body.
-->
<div class="fallback-message">
    <p>Your browser <b>doesn't support the features required</b> by impress.js, so you are presented with a simplified version of this presentation.</p>
    <p>For the best experience please use the latest <b>Chrome</b>, <b>Safari</b> or <b>Firefox</b> browser.</p>
</div>

<div id="impress">

<div id="intro" class="step slide" data-x="1000" data-y="-1000">
    <p style="margin-bottom: 15px;">Monday morning...</p>
    <p  style="margin-bottom: 15px;">
        Your boss wants to quickly deploy a restaurant reservation system to take advantage of a new public rest api created by the chamber of commerce. It  allows anyone to get information about restaurants and make reservations. The chamber of commerce plans to expand this service in the future, so she wants to get in on the ground floor.
    </p>
    <p style="margin-bottom: 15px;">
        Since your boss wants this application quickly, the web designer has already created up a mock up for you to use in building the application.
        Since you’ve been hearing about building SPAs; you’ve decided to use Backbone to build the application.
    </p>
    <p style="margin-bottom: 15px;">
        Let's get started!
    </p>
</div>

    <!-- Will be our standard text only slide -->
    <div id="text-0" class="step slide" data-x="1000" data-y="0">
        <p>
        We're going to go over some Backbone basics, and then we'll start coding.
        </p>
        <ul>
            <li>Scoping our modules.</li>
            <li>What is meant by 'extend'.</li>
            <li>The basic Model.</li>
            <li>The basic Collection.</li>
            <li>A quick wiring to REST.</li>
        </ul>
    </div>


<!-- ************************************************************* -->
    <div id="code-1" class="step" data-x="2000" data-y="0" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; ">
/*
 * Snippet 1. Providing a scope for our modules.
 */
(function () {
    "use strict";

    var RestaurantModule = {};
    window.RestaurantModule = RestaurantModule;

    return RestaurantModule;  // Preparation for Require.js
})();
/*
 * end
 */
        </pre>
        </span>
    </div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
    <div id="code-2" class="step" data-x="3000" data-y="0" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; ">
/*
 * Snippet 2. Understanding Extend
 */
var car = {
    type: 'car',
	name: "betsy",
    start: function() {
	  console.log("starting up " + this.type + " " + this.name);
    }
};

car.start();

var truck = {
    type: 'truck',
	name: 'mark',
	honk: function() {
	  console.log("honking horn of " + this.type + " " + this.name);
	}
};
truck.honk();

var suv = _.extend(car, truck);
suv.name = 'george';
suv.type = 'suv';
suv.start();
suv.honk();
/*
 * end
 */
        </pre>
        </span>
    </div>
    <!-- ************************************************************* -->

    <div id="output-2" class="step" data-x="3000" data-y="1000" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; ">
/*
 * Snippet 2 Output.
 */

Input into Firebug:
>>> var car = {     type: 'car',  	name: "betsy",   ...  suv.type = 'suv';  suv.start();  suv.honk();

starting up car betsy
honking horn of truck mark
starting up suv george
honking horn of suv george

/*
 * end
 */
        </pre>
        </span>
    </div>
    <!-- ************************************************************* -->

    <!-- ************************************************************* -->
    <div id="code-3" class="step" data-x="4000" data-y="0" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; ">

/*
 * Snippet 3. A basic Model    (restaurant.js)
 */
RestaurantModule.Restaurant = Backbone.Model.extend({
        defaults: {
            name: "undefined",
            location: "",
            reservations: [],
            availableTimes: []
        },
        urlRoot: "/restaurants"
    });
/*
 * end
 */

        </pre>
        </span>
    </div>
    <!-- ************************************************************* -->

    <!-- ************************************************************* -->
    <div id="code-4" class="step" data-x="5000" data-y="0" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; ">

/*
 * Snippet 4. A basic Collection    (restaurant.js)
 */
 RestaurantModule.RestaurantList = Backbone.Collection.extend({
        model: RestaurantModule.Restaurant,
        url: "/restaurants"
    });


Input into Firebug:
>>> var restaurants = new RestaurantModule.RestaurantList();
>>> restaurants.fetch();
>>> restaurants.forEach(function(r) { console.log(r.get('name') + ": " + r.get('id')) } )

/*
 * end
 */

        </pre>
        </span>
    </div>
    <!-- ************************************************************* -->

    <!-- ************************************************************* -->
    <div id="output-4" class="step" data-x="5000" data-y="1000" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; ">

/*
 * Snippet 4. Output
 */

Zarletti: 1ldmpLEtHGLCNmsI
Mader's: BpbLDcavDPJN6Opm
Kil@Wat: T2qnz5DwVU5hA0ar
Sanford: U0ojeKMKybKeTLMx
Eddie Martini's: aHsEQCTPyxqJguXe
Hinterland Erie Street Gastropub: b0CoyLZckATxWzNd
Carson's Ribs: go3IM27PHqaCWn1f
Shogun: hInHppsH5Qv8momc
Harbor House: wTbi8kZaYFiuZF7b
Bartolotta's Lake Park Bistro: zEFtfkz3z3nx7qlh

/*
 * end
 */

        </pre>
        </span>
    </div>
    <!-- ************************************************************* -->

    <!-- ************************************************************* -->
    <div id="class-1" class="step" data-x="6000" data-y="0" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; ">

/*
 * Exercise 1. Create the Model and Collection.  (restaurant.js)
 */

(function () {
    "use strict";

    var RestaurantModule = {};
    window.RestaurantModule = RestaurantModule;

    RestaurantModule.Restaurant = Backbone.Model.extend({
        defaults: {
            name: "undefined",
            location: "",
            reservations: [],
            availableTimes: []
        },
        urlRoot: "/restaurants"
    });

    RestaurantModule.RestaurantList = Backbone.Collection.extend({
        model: RestaurantModule.Restaurant,
        url: "/restaurants"
    });

    return RestaurantModule;  // Preparation for Require.js
})();

/*
 * end
 */

        </pre>
        </span>
    </div>
    <!-- ************************************************************* -->

<!-- ************************************************************* -->
    <div id="text-1" class="step slide" data-x="1000" data-y="2000">
        <p style="margin-bottom: 20px;">
            Can view the restaurants with try_it.html
        </p>
        <p style="margin-bottom: 20px;">
            Questions?
        </p>
        <p>
            @TODO Information on github TAG, etc.
        </p>
        <p>
            What's Next?
        </p>
        <ul>
            <li>Introducing Handlebars!</li>
            <li>A Basic View.</li>
            <li>A List View.</li>
        </ul>
    </div>
<!-- ************************************************************* -->


<!-- ************************************************************* -->
<div id="code-10" class="step" data-x="2000" data-y="2000" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; ">
    <!--
      -- A basic Handlebars template
      -->

     <div class="row">
         {{#if hasData}}
         <div>
             <p>Price: {{showPrice price}}</p>
         </div>
         <div>
             <p>Rating: {{showRating rating}}</p>
         </div>
         <div>
             <p>Address: {{address}}</p>
         </div>
         {{/if}}
     </div>

     <!--
      -- A basic Handlebars template
      -->
        </pre>
        </span>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="hb-template-1" class="step" data-x="2000" data-y="3000" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; ">
    <!--
      -- Resaurant template (restaurant.handlebars)
      -->

     <div class="row">
         <div class="large-12 columns">
             <div class="callout panel">
                 <p><strong>{{name}}</strong>{{#if tagline}}<br/>{{/if}}{{tagline}}</p>
                 <div class="row">
                     <div class="large-3 medium-6 small-12 columns">
                         <p>Price: {{showPrice price}}</p>
                     </div>
                     <div class="large-3 medium-6 small-12 columns">
                         <p>Rating: {{showRating rating}}</p>
                     </div>
                     <div class="large-6 medium-12 small-12 columns">
                         <p>Address: {{address}}</p>
                     </div>
                 </div>
                 <p>Description: {{description}} </p>
                 <div class="availableTimes">
                     <a href="#restaurant/{{id}}" name="restaurant-{{id}}" class="button restaurantRow" style="color: white;">Show Times</a>
                 </div>
                 <div class="reservationForm" />
             </div>
         </div>
     </div>

     <!--
      -- end
      -->
        </pre>
        </span>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="code-11" class="step" data-x="3000" data-y="2000" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; ">
    /*
     *  A basic View  (restaurant.js)
     */

    RestaurantModule.RestaurantView = Backbone.View.extend({
        initialize: function () {
            this.template = Handlebars.templates.restaurant;
        },
        render: function () {
            this.$el.html(this.template(this.model.toJSON()));
            return this;
        }
    });

    /*
     * end
     */
        </pre>
        </span>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="code-12" class="step" data-x="4000" data-y="2000" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; ">

    /*
     *  A Collection View (restaurant.js)
     */
    RestaurantModule.RestaurantListView = Backbone.View.extend({
        initialize: function () {
            this.template = Handlebars.templates.restaurantListView;
            this.restaurants = new RestaurantModule.RestaurantList();
            this.listenTo(this.restaurants, "add", this.addRestaurantView);
            this.restaurants.fetch();
        },
        render: function () {
            this.$el.html(this.template(this));
            return this;
        },
        addRestaurantView: function (restaurant) {
            var view = new RestaurantModule.RestaurantView({model: restaurant});
            this.$('.restaurantList').append(view.render().el);
        },
        count: function () {
            return this.restaurants.length;
        }
    });
    /*
     * end
     */

        </pre>
        </span>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="text-2" class="step slide" data-x="5000" data-y="2000">
    <p style="margin-bottom: 20px;">
        Time to add a main controller. This can be done a few different ways.
        <ul>
            <li>Simple Main</li>
            <li>Basic Router</li>
            <li>Delegate to modules.</li>
            <li>Routed Tabs</li>
            <li>Etc...</li>
        </ul>
    </p>
    <p style="margin-bottom: 20px;">
        Let's do a simple main to display our restaurants in the mock up that the web designer provided. This would
        give us something we could show our boss or bring to 'demo day' if we are doing Agile/Scrum.
    </p>

</div>
<!-- ************************************************************* -->


<!-- ************************************************************* -->
<div id="code-13" class="step" data-x="6000" data-y="2000" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; ">

    /*
     *  A Simple Main     (application.js)
     */
    var allRestaurantView = new RestaurantModule.RestaurantListView();

    var allRestaurantContent = $("#restaurant-list-main");

    allRestaurantContent.empty();
    allRestaurantContent.append(allRestaurantView.render().el);

    /*
     * end
     */

        </pre>
        </span>
</div>
<!-- ************************************************************* -->


<!-- ************************************************************* -->
<div id="text-3" class="step slide" data-x="1000" data-y="4000">
    <p style="margin-bottom: 20px;">
        <ul>
            <li>index.html should now be working and showing the Restaurants from the server.</li>
        </ul>
    </p>
    <p style="margin-bottom: 20px;">
        Questions?
    </p>
    <p>
        @TODO Information on github TAG, etc.
    </p>
    <p>
        <ul>
            <li>What's Next?</li>
            <li>We need to add code to select a restaurant and show available times.</li>
        </ul>
    </p>
    <ol>
        <li>Routers for selecting a restaurant.</li>
        <li>A little JQuery to control the main view.</li>
        <li>
            Modifications to modules and views.
            <ol>
                <li>Get reservations from the server.</li>
                <li>Add a time slot View.</li>
                <li>Modify restaurant View to show times.</li>
            </ol>
        </li>
        <li>Looping: Template VS Views</li>
    </ol>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="code-14" class="step" data-x="2000" data-y="4000" >

        <span style="font-size:  1rem;">
        <a class="jump" href="#hb-template-1">Back to the template.</a>
        <pre class="brush: js; ">
    /*
     * Create our router. (application.js)
     */
    $(document).ready(function(){
        var allRestaurantView = new RestaurantModule.RestaurantListView();

        var allRestaurantContent = $("#restaurant-list-main");
        var singleRestaurantContent = $("#selected-restaurant-main");

        allRestaurantContent.empty();
        allRestaurantContent.append(allRestaurantView.render().el);

        new (Backbone.Router.extend({
            routes: {
                "":"showRestaurants",
                "restaurant/:id": "selectRestaurant"
            },
            showRestaurants :function() {
                allRestaurantContent.show();
                singleRestaurantContent.hide();
            },
            selectRestaurant: function(id) {
                allRestaurantContent.hide();
                singleRestaurantContent.show();

                var selected = allRestaurantView.getRestaurantById(id);
                var singleRestaurantView = new RestaurantModule.RestaurantView({model:selected});
                singleRestaurantContent.empty().append(singleRestaurantView.el);
                singleRestaurantView.showTimes();
            }
        }))();

        allRestaurantView.on('ready', function() {
            Backbone.history.start();
        });
    });
    /*
     * end
     */
        </pre>



        </span>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="code-15" class="step" data-x="3000" data-y="4000" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; highlight: [13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]">
    /*
     *  Update Restaurant to fetch its reservations.  (restaurant.js)
     */
   RestaurantModule.Restaurant = Backbone.Model.extend({
        defaults: {
            name: "undefined",
            location: "",
            reservations: [],
            availableTimes: []
        },
        urlRoot: "/restaurants",
        fetchReservations: function () {
            $.ajax('/restaurants/' + this.get('id') + '/reservations', {
                context: this,
                success: function (response) {
                    this.set({
                        'reservations': response.reservations,
                        'availableTimes': response.available
                    });
                    this.trigger('fetchComplete');
                },
                failure: function () {
                    console.log(['Something strange is afoot', arguments]);
                }
            });
        }
    });
    /*
     * end
     */

        </pre>
        </span>
</div>
<!-- ************************************************************* -->


<!-- ************************************************************* -->
<div id="code-16" class="step" data-x="4000" data-y="4000" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; ">
    /*
     *  Add a TimeSlotView to show the times. (restaurant.js)
     */
    RestaurantModule.TimeSlotView = Backbone.View.extend({
        initialize:function(options){
            this.template = Handlebars.templates.availableTimes;
        },
        render:function(){
            this.$el.html(this.template(this.model.toJSON()));
            return this;
        }
    });

    /*
     * end
     */

        </pre>
        </span>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="code-17" class="step" data-x="5000" data-y="4000" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; highlight:[5,6,7,14,15,16,19,20,21,22,23]">
    /*
     *  Update the RestaurantView to show the times.   (restaurant.js)
     */
    RestaurantModule.RestaurantView = Backbone.View.extend({
        defaults: {
            selected:false
        },
        initialize: function () {
            this.template = Handlebars.templates.restaurant;
            this.listenTo(this.model, 'fetchComplete', this.render);
        },
        render: function () {
            this.$el.html(this.template(this.model.toJSON()));
            if (this.selected){
                this.$el.find(".availableTimes").html(this.availableTimes.render().el);
            }
            return this;
        },
        showTimes: function(){
            this.selected=true;
            this.availableTimes = new RestaurantModule.TimeSlotView({model:this.model});
            this.model.fetchReservations();
        }
    });

    /*
     * end
     */

        </pre>
        </span>
</div>
<!-- ************************************************************* -->


<!-- ************************************************************* -->
<div id="code-18" class="step" data-x="6000" data-y="4000" >
        <span style="font-size:  1.0rem;">
        <pre class="brush: js; highlight:[9,10,11,33,34,35,36]">
    /*
     *  Update the RestaurantView to add an event!    (restaurant.js)
     */
      RestaurantModule.RestaurantView = Backbone.View.extend({
        defaults: {
            formView: undefined,
            selected:false
        },
        events: {
            'click .availableTime': 'selectTime'
        },
        initialize: function () {
            this.template = Handlebars.templates.restaurant;
            this.listenTo(this.model, 'fetchComplete', this.render);
        },
        render: function () {
            if (this.formView) {
                this.$el.find('.reservationForm').detach();
                this.formView=undefined;
            }

            this.$el.html(this.template(this.model.toJSON()));
            if (this.selected){
                this.$el.find(".availableTimes").html(this.availableTimes.render().el);
            }
            return this;
        },
        showTimes: function(){
            this.selected=true;
            this.availableTimes = new RestaurantModule.TimeSlotView({model:this.model});
            this.model.fetchReservations();
        },
        selectTime: function (event) {
            var reservationTime = parseInt(event.currentTarget.getAttribute('value'));
            console.log("selected time: " + reservationTime);
        }
    });

    /*
     * end
     */

        </pre>
        </span>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="code-19" class="step" data-x="7000" data-y="4000" >
        <span style="font-size:  1.0rem;">
        <pre class="brush: js; highlight:[10,11,12,13,26,27,28]">
    /*
     *  Update the RestaurantListView to notify listeners when it is done loading.  (restaurant.js)
     */
      RestaurantModule.RestaurantListView = Backbone.View.extend({
        initialize: function () {
            this.template = Handlebars.templates.restaurantListView;
            this.restaurants = new RestaurantModule.RestaurantList();
            this.listenTo(this.restaurants, "add", this.addRestaurantView);

            _.bindAll(this, "fireReadyEvent");
            this.restaurants.fetch({
                success: this.fireReadyEvent
            });
        },
        render: function () {
            this.$el.html(this.template(this));
            return this;
        },
        addRestaurantView: function (restaurant) {
            var view = new RestaurantModule.RestaurantView({model: restaurant});
            this.$('.restaurantList').append(view.render().el);
        },
        count: function () {
            return this.restaurants.length;
        },
        fireReadyEvent: function () {
            this.trigger('ready');
        },
        getRestaurantById:function(id){
            return this.restaurants.get(id);
        }
    });
    /*
     * end
     */

        </pre>
        </span>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="hb-template-2" class="step" data-x="8000" data-y="4000" >
        <span style="font-size:  1.25rem;">
        <pre class="brush: js; ">
    <!--
      -- Available Times template (availableTimes.handlebars)
      -->

     <form>
         <fieldset>
             <legend>Available Times</legend>

             <div class="row">
                 {{#each availableTimes}}
                 <div class="large-3 medium-4 small-6 columns availableTime" value="{{this}}">
                     {{showTime this}}
                 </div>
                 {{/each}}
             </div>
         </fieldset>
     </form>

     <!--
      -- end
      -->
        </pre>
        </span>
</div>
<!-- ************************************************************* -->

<div id="compare-1" class="step "  data-x="7500" data-y="4000" data-scale="1.25">

</div>


<!-- ************************************************************* -->
<div id="text-4" class="step slide" data-x="1000" data-y="6000">
    <p style="margin-bottom: 20px;">
    <ul>
        <li>You should now be able to select a restaurant, and then select a time.</li>
    </ul>
    </p>
    <p style="margin-bottom: 20px;">
        Questions?
    </p>
    <p>
        @TODO Information on github TAG, etc.
    </p>
    <p>
    <ul>
        <li>What's Next?</li>
        <li>We need to create a Reservation model and form so we can add a reservation.</li>
    </ul>
    </p>
    <ol>
        <li>Reservation Model</li>
        <li>Reservation View (A form)</li>
        <li>Update our Restaurant View to show the Reservation Form.</li>
        <li>Discuss the back/forward buttons.</li>
    </ol>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="code-20" class="step" data-x="2000" data-y="6000" >
        <span style="font-size:  1.5rem;">
        <pre class="brush: js;">
    /*
     *  Create a Reservation Model. (reservation.js)
     */
    Reservation.Model = Backbone.Model.extend({
        urlRoot: "/reservations"
    });
    /*
     * end
     */

        </pre>
        </span>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="code-21" class="step" data-x="3000" data-y="6000" >
        <span style="font-size:  1.2rem;">
        <pre class="brush: js;">
    /*
     *  Create a Reservation Form View. (reservation.js)
     */
     Reservation.FormView = Backbone.View.extend({
        initialize: function (options) {
            this.template = Handlebars.templates.reservationForm;
            this.model = new Reservation.Model({
                restaurantId: options.restaurantId,
                time: options.reservationTime
            });
        },
        render: function () {
            this.$el.html(this.template(this.model.toJSON()));
            return this;
        }
    });
    /*
     * end
     */

        </pre>
        </span>
</div>
<!-- ************************************************************* -->


<!-- ************************************************************* -->
<div id="code-22" class="step" data-x="4000" data-y="6000" >
        <span style="font-size:  1.0rem;">
        <pre class="brush: js; highlight:[6,17,18,19,20,33,34,35,36,37,38,39,40,41]">
    /*
     *  Modify the Restaurant View to show the Reservation Form (restaurant.js)
     */
      RestaurantModule.RestaurantView = Backbone.View.extend({
        defaults: {
            formView: undefined,
            selected:false
        },
        events: {
            'click .availableTime': 'selectTime'
        },
        initialize: function () {
            this.template = Handlebars.templates.restaurant;
            this.listenTo(this.model, 'fetchComplete', this.render);
        },
        render: function () {
            if (this.formView) {
                this.$el.find('.reservationForm').detach();
                this.formView=undefined;
            }

            this.$el.html(this.template(this.model.toJSON()));
            if (this.selected){
                this.$el.find(".availableTimes").html(this.availableTimes.render().el);
            }
            return this;
        },
        showTimes: function(){
            this.selected=true;
            this.availableTimes = new RestaurantModule.TimeSlotView({model:this.model});
            this.model.fetchReservations();
        },
        selectTime: function (event) {
            var reservationTime = parseInt(event.currentTarget.getAttribute('value'));
            var view = new Reservation.FormView({
                restaurantId: this.model.get('id'),
                reservationTime: reservationTime
            });
            this.formView = view;
            this.$('.reservationForm').empty().append(view.render().el);
        }
    });
    /*
     * end
     */

        </pre>
        </span>
</div>
<!-- ************************************************************* -->


<!-- ************************************************************* -->
<div id="text-5" class="step slide" data-x="5000" data-y="6000">
    <p style="margin-bottom: 20px;">
    <ul>
        <li>The Back Button</li>
    </ul>
    </p>
    <p style="margin-bottom: 20px;">
        The Back button should work! So should bookmarks!
    </p>
    <ul>
        <li>The application doesn't process routes until data is ready.</li>
        <li>Routes are used to direct the front end.</li>
    </ul>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="text-6" class="step slide" data-x="1000" data-y="8000">
    <p style="margin-bottom: 20px;">
    <ul>
        <li>You should now be able to select a restaurant, and then select a time.</li>
        <li>Selecting a time should present the Reservation form.</li>
    </ul>
    </p>
    <p style="margin-bottom: 20px;">
        Questions?
    </p>
    <p>
        @TODO Information on github TAG, etc.
    </p>
    <p>
    <ul>
        <li>What's Next?</li>
        <li>We need to process the Reservation form, sending the information to the server and showing confirmation.</li>
    </ul>
    </p>
    <ol>
        <li>Modify Reservation Form View to process input.</li>
        <li>Add code to save the Reservation on the server.</li>
        <li>Adding an additional 'confirmation' View.
            <ul>
                <li>Add a Reservation view that isn't a form.</li>
                <li>Add an additional Route to view a Reservation as a confirmation.</li>
            </ul>
        </li>
    </ol>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="code-23" class="step" data-x="2000" data-y="8000" >
        <span style="font-size:  .8rem;">
        <pre class="brush: js; highlight:[12]">
     //  Modify Reservation Form View to add events. (reservation.js)
     Reservation.FormView = Backbone.View.extend({
        events: {
            'change input[type="text"]': 'changeGenericValue',
            'change input[type="number"]': 'changeGenericValue',
            'change select': 'changeGenericValue',
            "keypress input[type='text']": 'actOnEnter',
            "keypress input[type='number']": 'actOnEnter',
            'click .submitButton': 'submitReservationRequest',
            'click .cancelButton': 'cancelReservationRequest'
        },
        initialize: function (options) { /* Code Cut For Brevity */  },
        render: function () {
            this.$el.html(this.template(this.model.toJSON()));
            return this;
        },
        changeGenericValue: function (event) {
            var sValue = $(event.currentTarget).val();
            var sName = $(event.currentTarget).attr("name");

            // This creates a data binding to the model based on the attributes name/value pair.
            var temp = {};
            temp[sName] = sValue;

            this.model.set(temp, {silent: true});
        },
        actOnEnter: function (event) {
            if (event.keyCode != 13) {
                return;
            }

            event.preventDefault();
            this.changeGenericValue(event);
        },
        submitReservationRequest: function () {
            this.model.save(this.model,
                {wait: true,
                    success: function (model, response, options) {
                        Backbone.history.navigate("/reservation/"+model.id,{trigger:true});
                    },
                    error: function (model, xhr, options) {
                        console.log("Snap goes the request.");
                    }
                }
            );
            return false;
        },
        cancelReservationRequest: function () {
            this.remove();
            return false;
        }
    });
    // end

        </pre>
        </span>
</div>
<!-- ************************************************************* -->



<!-- ************************************************************* -->
<div id="code-24" class="step" data-x="3000" data-y="8000" >
        <span style="font-size:  .8rem;">
        <pre class="brush: js; highlight:[12]">
     //  Modify Reservation Form View to add events. (reservation.js)
     Reservation.FormView = Backbone.View.extend({
        events: {
            'change input[type="text"]': 'changeGenericValue',
            'change input[type="number"]': 'changeGenericValue',
            'change select': 'changeGenericValue',
            "keypress input[type='text']": 'actOnEnter',
            "keypress input[type='number']": 'actOnEnter',
            'click .submitButton': 'submitReservationRequest',
            'click .cancelButton': 'cancelReservationRequest'
        },
        initialize: function (options) { /* Code Cut For Brevity */  },
        render: function () {
            this.$el.html(this.template(this.model.toJSON()));
            return this;
        },
        changeGenericValue: function (event) {
            var sValue = $(event.currentTarget).val();
            var sName = $(event.currentTarget).attr("name");

            // This creates a data binding to the model based on the attributes name/value pair.
            var temp = {};
            temp[sName] = sValue;

            this.model.set(temp, {silent: true});
        },
        actOnEnter: function (event) {
            if (event.keyCode != 13) {
                return;
            }

            event.preventDefault();
            this.changeGenericValue(event);
        },
        submitReservationRequest: function () {
            this.model.save(this.model,
                {wait: true,
                    success: function (model, response, options) {
                        Backbone.history.navigate("/reservation/"+model.id,{trigger:true});
                    },
                    error: function (model, xhr, options) {
                        console.log("Snap goes the request.");
                    }
                }
            );
            return false;
        },
        cancelReservationRequest: function () {
            this.remove();
            return false;
        }
    });
    // end

        </pre>
        </span>
</div>
<!-- ************************************************************* -->


<!-- ************************************************************* -->
<div id="code-25" class="step" data-x="4000" data-y="8000" >
        <span style="font-size:  .8rem;">
        <pre class="brush: js; ">
     // Create a Reservation View (reservation.js)
        Reservation.View = Backbone.View.extend({
        events:{
            'click .reset':'closeReservationView'
        },
        initialize: function () {
            this.template = Handlebars.templates.reservation;
            this.model = new Reservation.Model();
            this.restaurant = new RestaurantModule.Restaurant();

            this.listenTo(this.model,"sync",this.fetchRestaurant);
            this.listenTo(this.model,"change",this.render);
            _.bindAll(this,"fetchRestaurantSuccess");
            _.bindAll(this,"fetchReservationSuccess");
        },
        render: function () {
            this.$el.html(this.template(this.model.toJSON()));
            return this;
        },
        closeReservationView:function(){
            Backbone.history.navigate("/",{trigger:true});
        },
        fetchRestaurant:function(){
            this.restaurant.set({id:this.model.get("restaurantId")},{silent:true});
            this.restaurant.fetch({
                success: this.fetchRestaurantSuccess,
                error: function (model, xhr, options) {
                    console.log("Snap goes the request.");
                }
            });
        },
        fetchRestaurantSuccess:function(model, response, options) {
            this.model.set({restaurantName:model.get('name')});
        },
        fetchReservationSuccess:function(model, response, options) {
            this.restaurant.set({id:model.get("restaurantId")});
        },
        fetchReservation:function(reservationId){
            this.model.set({id:reservationId},{silent:true});
            this.model.fetch({
                    success: this.fetchReservationSuccess,
                    error: function (model, xhr, options) {
                        console.log("Snap goes the request.");
                    }
                }
            );
        }
    });
    // end

        </pre>
        </span>
</div>
<!-- ************************************************************* -->


<!-- ************************************************************* -->
<div id="code-26" class="step" data-x="5000" data-y="8000" >
        <span style="font-size:  .8rem;">
        <pre class="brush: js; highlight:[6,15,21,26,33,34,35,36,37,38,39,40]">
     // Add a Reservation route to view completed reservations. (application.js)
     $(document).ready(function(){
        var allRestaurantView = new RestaurantModule.RestaurantListView();
        var allRestaurantContent = $("#restaurant-list-main");
        var singleRestaurantContent = $("#selected-restaurant-main");
        var reservationResultContent = $("#show-reservation-main");

        allRestaurantContent.empty();
        allRestaurantContent.append(allRestaurantView.render().el);

        new (Backbone.Router.extend({
            routes: {
                "":"showRestaurants",
                "restaurant/:id": "selectRestaurant",
                "reservation/:id":"showReservationResult"
            },

            showRestaurants :function() {
                allRestaurantContent.show();
                singleRestaurantContent.hide();
                reservationResultContent.hide();
            },
            selectRestaurant: function(id) {
                allRestaurantContent.hide();
                singleRestaurantContent.show();
                reservationResultContent.hide();

                var selected = allRestaurantView.getRestaurantById(id);
                var singleRestaurantView = new RestaurantModule.RestaurantView({model:selected});
                singleRestaurantContent.empty().append(singleRestaurantView.el);
                singleRestaurantView.showTimes();
            },
            showReservationResult:function(id){
                allRestaurantContent.hide();
                singleRestaurantContent.hide();
                reservationResultContent.show();
                var reservationView = new Reservation.View();
                reservationResultContent.empty().append(reservationView.el);
                reservationView.fetchReservation(id);
            }
        }))();

        allRestaurantView.on('ready', function() {
            Backbone.history.start();
        });
    });
    // end

        </pre>
        </span>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="text-7" class="step slide" data-x="1000" data-y="10000">
    <p style="margin-bottom: 20px;">
    <ul>
        <li>You should now be able to select a restaurant, and then select a time.</li>
        <li>Selecting a time should present the Reservation form.</li>
        <li>Submitting the form should present the Reservation page.</li>
    </ul>
    </p>
    <p style="margin-bottom: 20px;">
        Questions?
    </p>
    <p>
        @TODO Information on github TAG, etc.
    </p>
    <p>
    <ul>
        <li>What's Next?</li>
        <li>It's time to add validation to our reservation form.</li>
    </ul>
    </p>
    <ol>
        <li>A quick overview of validation.</li>
        <li>Add the Backbone.validation plugin.</li>
        <li>Add validation or our Reservation form View.</li>
    </ol>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="code-27" class="step" data-x="2000" data-y="10000" >
        <span style="font-size:  1.0rem;">
        <pre class="brush: js;">
    // Override how Backbone.validation handles validation messages. (application.js)

    // Extend backbone to find our error-box and show errors.
    _.extend(Backbone.Validation.callbacks, {
        valid: function (view, attr, selector) {
            view.$('[' + selector + '=' + attr + ']').removeClass('invalid');
            // remove from the list; and if empty; hide it.
            view.$('.error-box').find('li[name=' + attr + ']').remove();
            if (view.$('.error-box').find('ul li').length == 0) {
                view.$('.error-box').hide();
            }
        },
        invalid: function (view, attr, error, selector) {
            view.$('[' + selector + '=' + attr + ']').addClass('invalid');
            // show container, add to list (with name!).
            view.$('.error-box').find('li[name=' + attr + ']').remove();
            view.$('.error-box').show().find('.error-list').append(
                '<li name="' + attr + '">' + error + '</li>');
        }
    });
    // end
    <!--
        <div class="error-box">
            <ul class="error-list"></ul>
        </div>
    -->
    /*
    input.invalid {
        border: 2px solid red;
        background: yellow;
        font-size: 1.1em;
    }
    */

        </pre>
        </span>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="code-28" class="step" data-x="3000" data-y="10000" >
        <span style="font-size:  1.0rem;">
        <pre class="brush: js; highlight: [4,29]">
    // Add validation to the Reservation model. (reservation.js)
    Reservation.Model = Backbone.Model.extend({
        urlRoot: "/reservations",
        validation: {
            name: {
                required: true,
                minLength: 2,
                msg: "Please enter a valid first name"
            },
            phone: {
                required: true,
                fn: function (value) {
                    if (value !== undefined) {
                        var check = value.replace(/[\s\(\)]/g, '');
                        if (check.match(/^1?-?(\d{3})?-?\d{3}-?\d{4}$/) === null) {
                            return "Please enter a valid phone number"
                        }
                    }
                }
            },
            guests: {
                required: true,
                pattern: 'digits',
                range: [1, 10]
            },
            time: {
                required: true
            }
        }
    });

    // end

        </pre>
        </span>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="code-29" class="step" data-x="4000" data-y="10000" >
        <span style="font-size:  1.0rem;">
        <pre class="brush: js; highlight: [11,20,21,31]">
    // Modify the submission of the form to check validation. (reservation.js)
    Reservation.FormView = Backbone.View.extend({
        events: { /* ... */ },
        initialize: function (options) {
            this.template = Handlebars.templates.reservationForm;
            this.model = new Reservation.Model({
                restaurantId: options.restaurantId,
                time: options.reservationTime
            });

            Backbone.Validation.bind(this);
        },
        render: function () {
            this.$el.html(this.template(this.model.toJSON()));
            return this;
        },
        changeGenericValue: function (event) { /* ... */ },
        actOnEnter: function (event) {  /* ... */  },
        submitReservationRequest: function () {
            var validationResults = this.model.validate();
            if (this.model.isValid()) {
                this.model.save(null, {
                    success: function (model, response, options) {
                        console.log("SUCCESS");
                        Backbone.history.navigate("reservation/" + model.id, { trigger:true });
                    },
                    error: function (model, xhr, options) {
                        console.log("Snap goes the request.");
                    }
                });
            }
            return false;
        },
        cancelReservationRequest: function () {
            this.remove();
            return false;
        }
    });

    // end

        </pre>
        </span>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="text-8" class="step slide" data-x="1000" data-y="12000">
    <p style="margin-bottom: 20px;">
    <ul>
        <li>You should now be able to select a restaurant, and then select a time.</li>
        <li>Selecting a time should present the Reservation form.</li>
        <li>Submitting the form should present the Reservation page.</li>
        <li>You should no longer be able to commit an invalid reservation form.</li>
    </ul>
    </p>
    <p style="margin-bottom: 20px;">
        Questions?
    </p>
    <p>
        There is no Github tag, this was includes with the Validation code.
    </p>
    <p>
    <ul>
        <li>What's Next?</li>
        <li>Testing with QUnit.</li>
    </ul>
    </p>
    <ol>
        <li>We'll use QuUnit to test some our form validation.</li>
    </ol>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="code-30" class="step" data-x="2000" data-y="12000" >
        <span style="font-size:  1.0rem;">
        <pre class="brush: js;">
     // Modify the submission of the form to check validation. (reservation.js)
     var getReservation = function() {
        return new Reservation.Model({
            id: 'abc123',
            restaurantId: 'zyx987',
            name: 'Jerry Rice',
            phone: '1-800-123-4567',
            guests: 1,
            time: new Date().getTime()
        });
    };

    test("name-validation", function() {
        expect(2);

        var reservation = getReservation();
        ok(reservation.isValid(true), "Check valid model");

        reservation = getReservation();
        reservation.set('name', 'A');
        ok(reservation.isValid(true) === false, "Name is too short");
    });

    test("guests-validation", function() {

    });

    test("time-validation", function() {

    });

    test("phone-validation", function() {

    });

    // end

        </pre>
        </span>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<div id="text-9" class="step slide" data-x="1000" data-y="14000">
    <p style="margin-bottom: 20px;">
    <ul>
        <li>You should now be able to select a restaurant, and then select a time.</li>
        <li>Selecting a time should present the Reservation form.</li>
        <li>Submitting the form should present the Reservation page.</li>
        <li>You should no longer be able to commit an invalid reservation form.</li>
        <li>We have some basic tests in place for our form.</li>
    </ul>
    </p>
    <p style="margin-bottom: 20px;">
        Questions?
    </p>
    <p>
    <ul>
        <li>What's Next?</li>
        <li>Advanced Topics Demos</li>
    </ul>
    </p>
    <ol>
        <li>If we have time, we'll demo some advanced topics to give you an idea of their role in your project.</li>
        <li>Security</li>
        <li>Mobile</li>
    </ol>
</div>
<!-- ************************************************************* -->

<!-- ************************************************************* -->
<!-- ************************************************************* -->
    <!-- An overview step that shows all slides -->
    <div id="overview" class="step" data-x="3000" data-y="4500" data-scale="16">
    </div>


<div style="position: absolute; top: -400px; left:-1000px; font-size: 50rem; color: white; text-shadow: 2px 2px 2px #000000;">
    1.
</div>

</div>

<script>
if ("ontouchstart" in document.documentElement) { 
    document.querySelector(".hint").innerHTML = "<p>Tap on the left or right to navigate</p>";
}
</script>

<!--
    To make all described above really work, you need to include impress.js in the page.
    
    You also need to call a `impress().init()` function to initialize impress.js presentation.
    And you should do it in the end of your document. Not only because it's a good practice, but also
    because it should be done when the whole document is ready.
-->
<script type="text/javascript" src="scripts/shCore.js"></script>

<script type="text/javascript" src="scripts/shBrushJScript.js"></script>
<link type="text/css" rel="stylesheet" href="styles/shCoreDefault.css"/>
<link rel="stylesheet" type="text/css" href="styles/shThemeDefault.css" />


<script src="js/impress.js"></script>
<script>impress().init();</script>
<script type="text/javascript">SyntaxHighlighter.all();</script>

</body>
</html>
